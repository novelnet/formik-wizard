"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=require("formik"),r=e(require("immer")),n=e(require("react")),i=require("react-albus");function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(e){return e.reduce(function(e,t){return e[t.id]=t.initialValues,e},{})}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var u=n.createContext(null);function s(e){var i=e.step,o=e.Form,a=void 0===o?t.Form:o,u=e.FormWrapper,s=e.steps,c=e.wizard,l=e.formikProps,m=e.onSubmit,f=e.setStatus,d=e.status,p=e.values,v=e.setValues,S=n.useMemo(function(){return{canGoBack:s[0]!==i.id,currentStep:{id:i.id,progress:i.progress},isLastStep:i.isSubmitStep||s[s.length-1]===i.id}},[s,i]),b=n.useCallback(function(e){try{var t,n,o=function(){f(t)};f(void 0);var a=function(o,a){try{var u=function(){function o(){function r(e){if(t=e,Array.isArray(t)){var r=t;t=r[0],n=r[1]}v(a),n?setImmediate(c.push,n):setImmediate(c.next)}return i.onAction?Promise.resolve(i.onAction(e,p,c)).then(r):r(void 0)}var a=r(p,function(t){t[S.currentStep.id]=e}),u=function(){if(S.isLastStep)return Promise.resolve(m(a,i)).then(function(){})}();return u&&u.then?u.then(o):o()}()}catch(e){return a(e)}return u&&u.then?u.then(void 0,a):u}(0,function(e){t=e});return Promise.resolve(a&&a.then?a.then(o):o())}catch(e){return Promise.reject(e)}},[S.currentStep,S.isLastStep,m,f,v,i,p,c.next]);return n.createElement(t.Formik,Object.assign({},l,{enableReinitialize:!0,initialValues:i.initialValues,validationSchema:i.validationSchema,validate:i.validate,onSubmit:b}),function(e){return n.createElement(a,{onSubmit:e.handleSubmit},n.createElement(u,Object.assign({},S,{steps:s,wizard:c,actionLabel:i.actionLabel,isSubmitting:e.isSubmitting,goToPreviousStep:function(){f(void 0),i.keepValuesOnPrevious&&v(function(t){return r(t,function(t){t[i.id]=e.values})}),c.previous()},status:d,values:p,setStatus:f,setValues:v}),n.createElement(i.component)))})}function c(e){var t=e.formikProps,r=e.albusProps,c=e.onSubmit,l=e.steps,m=e.Form,f=e.render,d=n.useState(void 0),p=d[0],v=d[1],S=n.useState(function(){return a(l)}),b=S[0],y=S[1];n.useEffect(function(){y(a(l)),v(void 0)},[l]);var h=n.useMemo(function(){return l.map(function(e){return e.id})},[l]);return n.createElement(i.Wizard,Object.assign({},r),n.createElement(u.Provider,{value:{status:p,setStatus:v,values:b,setValues:y}},n.createElement(i.Steps,null,l.map(function(e){return n.createElement(i.Step,{key:e.id,id:e.id,render:function(r){return n.createElement(s,{wizard:r,formikProps:t,onSubmit:c,steps:h,status:p,values:b,setValues:y,setStatus:v,step:o({},e,{initialValues:b[e.id]||{}}),Form:m,FormWrapper:f})}})}))))}exports.FormikWizard=c,exports.default=c,exports.useFormikWizard=function(){return n.useContext(u)};
//# sourceMappingURL=formik-wizard.cjs.production.min.js.map
