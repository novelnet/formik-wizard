"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=require("formik"),r=e(require("immer")),n=e(require("react")),i=require("react-albus");function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(e){return e.reduce(function(e,t){return e[t.id]=t.initialValues,e},{})}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var a=n.createContext(null);function s(e){var i=e.step,o=e.Form,u=void 0===o?t.Form:o,a=e.FormWrapper,s=e.steps,c=e.wizard,l=e.formikProps,m=e.onSubmit,f=e.setStatus,p=e.status,d=e.values,S=e.setValues,v=n.useMemo(function(){return{canGoBack:s[0]!==i.id,currentStep:{id:i.id,progress:i.progress,isSubmitStep:i.isSubmitStep},isLastStep:i.isSubmitStep||s[s.length-1]===i.id}},[s,i]),b=n.useCallback(function(e){try{var t,n,o=function(){f(t)};f(void 0);var u=function(o,u){try{var a=function(){function o(){function r(e){if(t=e,Array.isArray(t)){var r=t;t=r[0],n=r[1]}S(u),n?setImmediate(c.push,n):setImmediate(c.next)}return i.onAction?Promise.resolve(i.onAction(e,d,c)).then(r):r(void 0)}var u=r(d,function(t){t[v.currentStep.id]=e}),a=function(){if(v.isLastStep)return Promise.resolve(m(u,i)).then(function(){})}();return a&&a.then?a.then(o):o()}()}catch(e){return u(e)}return a&&a.then?a.then(void 0,u):a}(0,function(e){t=e});return Promise.resolve(u&&u.then?u.then(o):o())}catch(e){return Promise.reject(e)}},[v.currentStep,v.isLastStep,m,f,S,i,d,c.next]);return n.createElement(t.Formik,Object.assign({},l,{enableReinitialize:!0,initialValues:i.initialValues,validationSchema:i.validationSchema,validate:i.validate,onSubmit:b}),function(e){return n.createElement(u,{onSubmit:e.handleSubmit},n.createElement(a,Object.assign({},v,{steps:s,wizard:c,actionLabel:i.actionLabel,isSubmitting:e.isSubmitting,goToPreviousStep:function(){f(void 0),i.keepValuesOnPrevious&&S(function(t){return r(t,function(t){t[i.id]=e.values})}),c.previous()},status:p,values:d,setStatus:f,setValues:S}),n.createElement(i.component)))})}function c(e){var t=e.formikProps,r=e.albusProps,c=e.onSubmit,l=e.steps,m=e.Form,f=e.render,p=n.useState(void 0),d=p[0],S=p[1],v=n.useState(function(){return u(l)}),b=v[0],y=v[1];n.useEffect(function(){y(u(l)),S(void 0)},[l]);var h=n.useMemo(function(){return l.map(function(e){return e.id})},[l]);return n.createElement(i.Wizard,Object.assign({},r),n.createElement(a.Provider,{value:{status:d,setStatus:S,values:b,setValues:y}},n.createElement(i.Steps,null,l.map(function(e){return n.createElement(i.Step,{key:e.id,id:e.id,render:function(r){return n.createElement(s,{wizard:r,formikProps:t,onSubmit:c,steps:h,status:d,values:b,setValues:y,setStatus:S,step:o({},e,{initialValues:b[e.id]||{}}),Form:m,FormWrapper:f})}})}))))}exports.FormikWizard=c,exports.default=c,exports.useFormikWizard=function(){return n.useContext(a)};
//# sourceMappingURL=formik-wizard.cjs.production.min.js.map
