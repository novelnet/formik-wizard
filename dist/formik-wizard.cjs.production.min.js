"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=require("formik"),r=e(require("immer")),n=e(require("react")),i=require("react-albus"),a=require("@reach/router"),u=e(require("qs"));function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(e,t){var r=u.parse(t,{ignoreQueryPrefix:!0});return e.reduce(function(e,t){return Object.keys(r).forEach(function(e){t.initialValues&&e in t.initialValues&&(t.initialValues[e]=r[e])}),e[t.id]=t.initialValues,e},{})}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var c=n.createContext(null);function l(e){var i=e.step,a=e.Form,u=void 0===a?t.Form:a,o=e.FormWrapper,s=e.steps,c=e.wizard,l=e.formikProps,m=e.onSubmit,f=e.setStatus,p=e.status,d=e.values,S=e.setValues,v=n.useMemo(function(){return{canGoBack:s[0]!==i.id,currentStep:{id:i.id,progress:i.progress,isSubmitStep:i.isSubmitStep,canGoBack:i.canGoBack},isLastStep:i.isSubmitStep||s[s.length-1]===i.id}},[s,i]),b=n.useCallback(function(e){try{function t(){f(n)}var n,a;f(void 0);var u=function(t,u){try{var o=function(){function t(){function t(e){if(n=e,Array.isArray(n)){var t=n;n=t[0],a=t[1]}S(u),a?c.push(a):c.next()}return i.onAction?Promise.resolve(i.onAction(e,d,c)).then(t):t(void 0)}var u=r(d,function(t){t[v.currentStep.id]=e}),o=function(){if(v.isLastStep)return Promise.resolve(m(u,i)).then(function(){})}();return o&&o.then?o.then(t):t()}()}catch(e){return u(e)}return o&&o.then?o.then(void 0,u):o}(0,function(e){n=e});return Promise.resolve(u&&u.then?u.then(t):t())}catch(e){return Promise.reject(e)}},[v.currentStep,v.isLastStep,m,f,S,i,d,c.next]);return n.createElement(t.Formik,Object.assign({},l,{enableReinitialize:!0,initialValues:i.initialValues,validationSchema:i.validationSchema,validate:i.validate,onSubmit:b}),function(e){return n.createElement(u,{onSubmit:e.handleSubmit},n.createElement(o,Object.assign({},v,{steps:s,wizard:c,actionLabel:i.actionLabel,isSubmitting:e.isSubmitting,goToPreviousStep:function(){f(void 0),i.keepValuesOnPrevious&&S(function(t){return r(t,function(t){t[i.id]=e.values})}),c.previous()},status:p,values:d,setStatus:f,setValues:S}),n.createElement(i.component)))})}function m(e){var t=e.formikProps,r=e.albusProps,u=e.onSubmit,m=e.steps,f=e.Form,p=e.render,d=a.useLocation().search,S=n.useState(void 0),v=S[0],b=S[1],y=n.useState(function(){return s(m,d)}),h=y[0],k=y[1];n.useEffect(function(){k(s(m,d)),b(void 0)},[m]);var P=n.useMemo(function(){return m.map(function(e){return e.id})},[m]);return n.createElement(i.Wizard,Object.assign({},r),n.createElement(c.Provider,{value:{status:v,setStatus:b,values:h,setValues:k}},n.createElement(i.Steps,null,m.map(function(e){return n.createElement(i.Step,{key:e.id,id:e.id,render:function(r){return n.createElement(l,{wizard:r,formikProps:t,onSubmit:u,steps:P,status:v,values:h,setValues:k,setStatus:b,step:o({},e,{initialValues:h[e.id]||{}}),Form:f,FormWrapper:p})}})}))))}exports.FormikWizard=m,exports.default=m,exports.useFormikWizard=function(){return n.useContext(c)};
//# sourceMappingURL=formik-wizard.cjs.production.min.js.map
